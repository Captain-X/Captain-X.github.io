<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="stat," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="逆变换法随机变量$X$的分布函数为$F(x)$，定义$F^{-1}(y)=\inf \{x:F(x)\ge y\},0\le y\le1$. 有定理：设随机变量$U$服从$(0,1)$上均匀分布，则$X=F^{-1}(U)$的分布函数为$F(x)$. ($P(X\le x)=P(F^{-1}(U)\le x)=P(U\le F(x))=F(x)$)
例：设$X_1,\cdots, X_n$是来自$">
<meta property="og:type" content="article">
<meta property="og:title" content="随机数的产生">
<meta property="og:url" content="https://Captain-X.github.io/6.1/index.html">
<meta property="og:site_name" content="Vinci">
<meta property="og:description" content="逆变换法随机变量$X$的分布函数为$F(x)$，定义$F^{-1}(y)=\inf \{x:F(x)\ge y\},0\le y\le1$. 有定理：设随机变量$U$服从$(0,1)$上均匀分布，则$X=F^{-1}(U)$的分布函数为$F(x)$. ($P(X\le x)=P(F^{-1}(U)\le x)=P(U\le F(x))=F(x)$)
例：设$X_1,\cdots, X_n$是来自$">
<meta property="og:updated_time" content="2018-02-27T10:54:27.927Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="随机数的产生">
<meta name="twitter:description" content="逆变换法随机变量$X$的分布函数为$F(x)$，定义$F^{-1}(y)=\inf \{x:F(x)\ge y\},0\le y\le1$. 有定理：设随机变量$U$服从$(0,1)$上均匀分布，则$X=F^{-1}(U)$的分布函数为$F(x)$. ($P(X\le x)=P(F^{-1}(U)\le x)=P(U\le F(x))=F(x)$)
例：设$X_1,\cdots, X_n$是来自$">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="https://Captain-X.github.io/6.1/"/>

  <title> 随机数的产生 | Vinci </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Vinci</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                随机数的产生
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2018-01-09T01:20:20-05:00" content="2018-01-09">
              2018-01-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Statistical-Computation-Methods/" itemprop="url" rel="index">
                    <span itemprop="name">Statistical Computation Methods</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="逆变换法"><a href="#逆变换法" class="headerlink" title="逆变换法"></a>逆变换法</h3><p>随机变量$X$的分布函数为$F(x)$，定义$F^{-1}(y)=\inf \{x:F(x)\ge y\},0\le y\le1$. 有定理：设随机变量$U$服从$(0,1)$上均匀分布，则$X=F^{-1}(U)$的分布函数为$F(x)$. ($P(X\le x)=P(F^{-1}(U)\le x)=P(U\le F(x))=F(x)$)</p>
<p>例：设$X_1,\cdots, X_n$是来自$F(x)$的一个样本，$Y_1=\min(X_1,\cdots,X_n)$，我们要产生来自$Y_1$的随机数。产生$n$个来自$F(x)$的独立随机变量并求最小值是不必要的，如下可直接产生来自$G(y)$的随机数，譬如，若$F(x)=x,0\le x\le 1,$ 则$Y_1=1-U^{1/n}$.<br>$$<br>F_{Y_1}(y)=1-[1-F(y)]^n:=G(y)\\<br>Y_1=G^{-1}(U)=F^{-1}(1-(1-U)^{1/n})=F^{-1}(1-U^{1/n})<br>$$<br>又例：设连续随机变量$X$的密度函数为<br>$$<br>p(x)=\begin{cases}<br>c_i,\quad x_i\le x&lt;x_{i+1}, i=0,\cdots,n-1\\<br>0, \quad\text{otherwise}<br>\end{cases}\\<br>\text{where }c_i&gt;0, a=x_0&lt;\cdots&lt;x_n=b<br>$$<br>令$p_i=\int_a^{x_i}f(x){\rm d}x,i=1,\cdots, n$，则对任一$x$，令$i=\max\{j:x_j\le x\}$，有$F(x)=p_i+c_i(x-x_i)$，由$\boldsymbol{F(X)=U}$可解出$X=x_i+(U-p_i)/c_i$，由$i$定义，$p_i\le U&lt;p_{i+1}$. 所以首先产生$(0,1)$上随机数$U$，然后确定$i$，最后计算$x=x_i+(u-x_i)/c_i$.</p>
<h3 id="合成法"><a href="#合成法" class="headerlink" title="合成法"></a>合成法</h3><p>如果$X$的密度函数$p(x)$难于抽样，而$X$关于$Y$的条件密度函数$p(x|y)$以及$Y$的密度函数$g(y)$均易于抽样，则$X$的随机数可先按$Y$的分布$g(y)$抽取$y$，然后由条件分布$p(x|y)$抽取$x$. </p>
<p>例：设$X$的密度函数为$p(x)=\sum_{i=1}^n \alpha_ip_i(x)$，其中诸$\alpha_i&gt;0,\sum_{i=1}^n\alpha_i=1$，$p_i(x)$是密度函数。令$\alpha_0=0$。则$X$的随机数可如下抽取：(1)由$U(0,1)$抽取$u$；(2)确定$i$，使$\sum_{j=0}^{i-1}\alpha_j&lt;u\le\sum_{j=0}^i\alpha_j$；(3)由$p_i(x)$抽取$x$. 这里的理解是$\alpha_i$相当于$p_i$的权重，先通过一个$(0,1)$内的随机数确定$\alpha_i$，$\alpha_i$被抽中的概率正比于其大小，抽中$\alpha_i$后就认为$X$的密度函数为$p_i(x)$，再抽取$x$.</p>
<p>譬如 ，$p(x)=(1+2x)/6,0&lt;x&lt;2$，其分布函数为$F(x)=(x+x^2)/6$，若用逆变换法抽样，则要解二次方程，较为麻烦。考虑用合成法，将$p(x)$分解，$p_1(x)=1/2,0&lt;x&lt;2,$$p_2(x)=x/2,0&lt;x&lt;2$,$\alpha_1=1/3,\alpha_2=2/3$. 则先由$U(0,1)$独立地抽取$u_1,u_2$，然后计算<br>$$<br>x=\begin{cases}<br>2u_2,&amp;u_1&lt;1/3\\<br>2\sqrt{u_2},&amp;u_1\ge1/3\\<br>\end{cases}<br>$$</p>
<h3 id="筛选法"><a href="#筛选法" class="headerlink" title="筛选法"></a>筛选法</h3><p>如果可以将$p(x)$表示成$p(x)=c\cdot h(x)\cdot g(x)$，其中$h(\cdot)$是一个密度函数并且易于抽样，而$0<g(x)\le1,c\ge1$是常数，则$x$的抽样可如下进行. （一点理解？：p(x)是以分布h(x)为基础，给那些使$g(x)$更大的$x$赋予更高的概率，这跟$p(x),g(x)$正相关是符合的）="" $$="" \begin{cases}="" (1)由u(0,1)抽取u，由h(y)抽取y\\="" (2)如果u\le="" g(y),则x="y，停止\\" (3)如果u="">g(y),回到(1)\\<br>\end{cases}<br>$$<br>证明：令$U,Y$分别服从$U(0,1)$和$h(y)$，在$U\le g(Y)$的条件下，$Y$的条件密度为<br>$$<br>\begin{align}<br>p_Y(x|U\le g(Y))&amp;=\frac{P(U\le g(Y)|Y=x)h(x)}{P(U\le g(Y))}\\<br>&amp;=\frac{P(U\le g(x))h(x)}{\mathbb E(g(Y))}\\<br>&amp;=\frac{g(x)h(x)}{\int g(y)h(y){\rm d}y}\\<br>&amp;=\frac{c\cdot g(x)h(x)}{\int c\cdot g(y)h(y){\rm d}y}\\<br>&amp;=p(x)<br>\end{align}<br>$$<br>$h(x)$的选取有多种方法。一种直观的方法是：如果存在一个函数$M(x)$，满足$p(x)\le M(x)$（这是寻找的关键，因为要构建$0&lt;g(x)\le 1$），且$c=\int M(x){\rm d}x&lt;\infty$，所以取$g(x)=p(x)/M(x)$，然后要从$M(x)$中提出一个常数得到一个定义域上积分为1的函数作为密度函数$h(x)$，所以$c=\int M(x){\rm d}x$. 特别地，若$X$的取值空间有限，如$X\sim p(x),-\infty&lt;a\le x\le b&lt;\infty$，并设$M=\sup p(x)$存在，则可取$h(x)=1/(b-a),$$c=M(b-a),$$g(x)=p(x)/M.$ 例：设$p(x)=4x^3,0\le x \le 1.$ 则可令$M=4,h(x)=1,g(x)=x^3\quad [p(x)=4\cdot1\cdot x^3]$</g(x)\le1,c\ge1$是常数，则$x$的抽样可如下进行.></p>
<p>例：设$X\sim p(x)=\frac{1}{\Gamma(\alpha)}x^{\alpha-1}e^{-x},x&gt;0,0&lt;\alpha<1$已知。注意到 $$="" p(x)\le="" m(x)="\begin{cases}" \frac{1}{\gamma(\alpha)}x^{\alpha-1},&0<x\le="" 1\\="" \frac{1}{\gamma(\alpha)}e^{-x},&x="">1\\<br>\end{cases}\\<br>c=\int_0^\infty M(x){\rm d}x=\frac{1/\alpha+1/e}{\Gamma(\alpha)}\\<br>令g(x)=<br>\begin{cases}<br>e^{-x},&amp;0<x\le 1\\="" x^{\alpha-1},&x="">1\\<br>\end{cases}\\<br>h(x)=M(x)/c=<br>\begin{cases}<br>\frac{x^{\alpha-1}}{1/\alpha+1/e},&amp;0<x\le 1\\="" \frac{e^{-x}}{1="" \alpha+1="" e},&x="">1\\<br>\end{cases}\\<br>\\<br>\begin{cases}<br>(1)由U(0,1)抽取u\\<br>(2)由h(y)抽取y,(逆变换法，分段函数)\\<br>(2)当0<y\le1,如果u\le e^{-x},则x="y,否则回到(1)\\" (3)当y="">1,如果u\le y^{\alpha-1},则x=y,否则回到(1)\\<br>\end{cases}<br>$$<br>TBC</y\le1,如果u\le></x\le></x\le></1$已知。注意到></p>
<p>连续分布的抽样方法</p>
<p>离散分布的抽样方法</p>
<p>随机向量的抽样方法</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/stat/" rel="tag">#stat</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/5.5/" rel="next" title="Bayes分析">
                <i class="fa fa-chevron-left"></i> Bayes分析
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/6.2/" rel="prev" title="随机模拟计算">
                随机模拟计算 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://zccz14.com/images/avatar.png"
               alt="dada" />
          <p class="site-author-name" itemprop="name">dada</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Captain-X/" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://zccz14.com/" title="zccz14" target="_blank">zccz14</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#逆变换法"><span class="nav-number">1.</span> <span class="nav-text">逆变换法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#合成法"><span class="nav-number">2.</span> <span class="nav-text">合成法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#筛选法"><span class="nav-number">3.</span> <span class="nav-text">筛选法</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dada</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  

</body>
</html>
